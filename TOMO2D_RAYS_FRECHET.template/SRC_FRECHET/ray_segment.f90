ray_segment_P1.f90